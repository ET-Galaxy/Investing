"0","#Create forecasts"
"0",""
"0","### must specify how many days ahead forecast is for###"
"0","n.forc = 54 # lose 2 days of data + 7 days ahead"
"0",""
"0","# Create the forecasts"
"0","# This gives the forecasts of delta"
"0","forcout = predict(out$model,n.ahead = n.forc,interval=c('prediction'),"
"0","                  level=0.68,states=c('trend','custom'))"
"0",""
"0","# Create empty dataframe to put forecasts in"
"0","forecasts <- matrix(NA,ncol=1,nrow=n.forc) %>%"
"0","  as.data.frame()"
"0","colnames(forecasts) = c('Admissions')"
"0",""
"0","# Compute forecasts as per (7) in Andrew's Time Series Models for Epidemics paper"
"0","# Confidence intervals computed as per Harvey, Kattuman and Thamotheram 2021 NIESR paper"
"0","forecasts$Admissions[1] = tail(as.vector(data_xts$cAdmit),1)*exp(forcout[1,1])"
"0","forecasts$Admissions[2:n.forc] = tail(as.vector(data_xts$cAdmit),1)*exp(forcout[2:n.forc,1])*cumprod(1+exp(forcout[1:(n.forc-1),1]))"
"0",""
"0","forecasts$Admissions.lwr[1] = tail(as.vector(data_xts$cAdmit),1)*exp(forcout[1,2])"
"0","forecasts$Admissions.lwr[2:n.forc] = tail(as.vector(data_xts$cAdmit),1)*exp(forcout[2:n.forc,2])*cumprod(1+exp(forcout[1:(n.forc-1),2])) "
"0",""
"0","forecasts$Admissions.upr[1] = tail(as.vector(data_xts$cAdmit),1)*exp(forcout[1,3])"
"0","forecasts$Admissions.upr[2:n.forc] = tail(as.vector(data_xts$cAdmit),1)*exp(forcout[2:n.forc,3])*cumprod(1+exp(forcout[1:(n.forc-1),3])) "
"0",""
"0","# Round forecasts to nearest whole number"
"0","forecasts = round(forecasts)"
"0",""
"0","admissions_forecasts = cbind(forecasts$Admissions,forecasts$Admissions.lwr,forecasts$Admissions.upr)"
"0","colnames(admissions_forecasts) = c('forc','lwr','upr')"
"0",""
"0","startforc = (data_xts %>% index %>% tail(1))+1"
"0","finds = seq(startforc,length.out = n.forc,by='day')"
