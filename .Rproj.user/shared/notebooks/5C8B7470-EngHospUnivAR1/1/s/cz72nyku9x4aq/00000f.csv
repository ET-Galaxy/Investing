"0","# Re-do with seasonal component"
"0",""
"0","forcout_sea = predict(out$model,n.ahead = n.forc,interval=c('prediction'),"
"0","                      level=0.68,states='all')"
"0",""
"0","# Create empty dataframe to put forecasts in"
"0","forecasts_sea <- matrix(NA,ncol=1,nrow=max(n.forc)) %>%"
"0","  as.data.frame()"
"0","colnames(forecasts_sea) = c('Admissions')"
"0",""
"0","# Compute forecasts as per (7) in Andrew's Time Series Models for Epidemics paper"
"0","# Confidence intervals computed as per Harvey, Kattuman and Thamotheram 2021 NIESR paper"
"0","forecasts_sea$Admissions[1] = tail(as.vector(data_xts$cAdmit),1)*exp(forcout_sea[1,1])"
"0","forecasts_sea$Admissions[2:n.forc] = tail(as.vector(data_xts$cAdmit),1)*exp(forcout_sea[2:n.forc,1])*cumprod(1+exp(forcout_sea[1:(n.forc-1),1]))"
"0",""
"0","forecasts_sea$Admissions.lwr[1] = tail(as.vector(data_xts$cAdmit),1)*exp(forcout_sea[1,2])"
"0","forecasts_sea$Admissions.lwr[2:n.forc] = tail(as.vector(data_xts$cAdmit),1)*exp(forcout_sea[2:n.forc,2])*cumprod(1+exp(forcout_sea[1:(n.forc-1),2]))"
"0","forecasts_sea$Admissions.upr[1] = tail(as.vector(data_xts$cAdmit),1)*exp(forcout_sea[1,3])"
"0","forecasts_sea$Admissions.upr[2:n.forc] = tail(as.vector(data_xts$cAdmit),1)*exp(forcout_sea[2:n.forc,3])*cumprod(1+exp(forcout_sea[1:(n.forc-1),3]))"
"0",""
"0","# Round forecasts to nearest whole number"
"0","forecasts_sea = cbind(forecasts_sea$Admissions,forecasts_sea$Admissions.lwr,forecasts_sea$Admissions.upr) %>% round()"
"0","colnames(forecasts_sea) = c('forc','lwr','upr')"
