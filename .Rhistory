lines(data_list[[i]]$Price, col=palet[i],lwd=1)
}
# Add legend
legend("topleft", legend = c("Portfolio",stocks),
col=c("blue",palet), lwd = 1,
bty = "n",            # Remove border
cex = 0.5,            # Increase text size
xpd = TRUE)           # Allow drawing outside plot region)
initial_wealth=1
allocation=c(0,0,0,0,1)
horizon=301
wealth_dist=matrix(nrow=301, ncol=5)
wealth_dist[1,]=allocation
portfolio<-numeric(horizon)
portfolio[1]<-1
# Define stock tickers
stocks <- c("NVDA", "AAPL", "AVGO", "JPM", "TSM")
palet <- c("green", "grey","red","navy", "pink")
# Read all CSV files and store them in a named list
data_list <- lapply(stocks, function(ticker) {
df <- read.csv(paste0(ticker, ".csv"))[,-7]  # Remove 7th column
df$Date <- as.Date(df$Date, format="%d/%m/%Y")  # Convert Date column
df<-arrange(df, Date)
df$Change <- c(NA, diff(df$Price)) / df$Price  # Calculate daily price change
df$Price<-df$Price/df$Price[1]
return(df)
})
# Assign names to the list for easier reference
names(data_list) <- stocks
change_df<-data_list[[1]]$Date
for (i in 1:length(stocks)){
change_df<-cbind(change_df,data_list[[i]]$Change)
}
for (i in 2:horizon){
wealth_dist[i,]<-wealth_dist[i-1,]*(1+change_df[i,-1])
portfolio[i]=sum(wealth_dist[i,])
props<-wealth_dist[i,]/portfolio[i]
if (any(abs(props-allocation)>5*allocation)){
wealth_dist[i,]<-portfolio[i]/length(stocks)
}
}
plot(portfolio, type = "l", col = "blue", lwd = 2, ylim = c(1,3),
xlab = "Time", ylab = "Price", main = "Portfolio")
for (i in 1:length(stocks)){
lines(data_list[[i]]$Price, col=palet[i],lwd=1)
}
# Add legend
legend("topleft", legend = c("Portfolio",stocks),
col=c("blue",palet), lwd = 1,
bty = "n",            # Remove border
cex = 0.5,            # Increase text size
xpd = TRUE)           # Allow drawing outside plot region)
library(tidyverse)
initial_wealth=1
allocation=c(1,0,0,0,0)
horizon=301
wealth_dist=matrix(nrow=301, ncol=5)
wealth_dist[1,]=allocation
portfolio<-numeric(horizon)
portfolio[1]<-1
# Define stock tickers
stocks <- c("NVDA", "AAPL", "AVGO", "JPM", "TSM")
palet <- c("green", "grey","red","navy", "pink")
# Read all CSV files and store them in a named list
data_list <- lapply(stocks, function(ticker) {
df <- read.csv(paste0(ticker, ".csv"))[,-7]  # Remove 7th column
df$Date <- as.Date(df$Date, format="%d/%m/%Y")  # Convert Date column
df<-arrange(df, Date)
df$Change <- c(NA, diff(df$Price)) / df$Price  # Calculate daily price change
df$Price<-df$Price/df$Price[1]
return(df)
})
# Assign names to the list for easier reference
names(data_list) <- stocks
change_df<-data_list[[1]]$Date
for (i in 1:length(stocks)){
change_df<-cbind(change_df,data_list[[i]]$Change)
}
for (i in 2:horizon){
wealth_dist[i,]<-wealth_dist[i-1,]*(1+change_df[i,-1])
portfolio[i]=sum(wealth_dist[i,])
props<-wealth_dist[i,]/portfolio[i]
if (any(abs(props-allocation)>5*allocation)){
wealth_dist[i,]<-portfolio[i]/length(stocks)
}
}
plot(portfolio, type = "l", col = "blue", lwd = 2, ylim = c(1,3),
xlab = "Time", ylab = "Price", main = "Portfolio")
for (i in 1:length(stocks)){
lines(data_list[[i]]$Price, col=palet[i],lwd=1)
}
# Add legend
legend("topleft", legend = c("Portfolio",stocks),
col=c("blue",palet), lwd = 1,
bty = "n",            # Remove border
cex = 0.5,            # Increase text size
xpd = TRUE)           # Allow drawing outside plot region)
initial_wealth=1
allocation=c(1,0,0,0,0)
horizon=301
wealth_dist=matrix(nrow=horizon, ncol=5)
wealth_dist[1,]=allocation
portfolio<-numeric(horizon)
portfolio[1]<-1
# Define stock tickers
stocks <- c("NVDA", "AAPL", "AVGO", "JPM", "TSM")
palet <- c("green", "grey","red","navy", "pink")
# Read all CSV files and store them in a named list
data_list <- lapply(stocks, function(ticker) {
df <- read.csv(paste0(ticker, ".csv"))[,-7]  # Remove 7th column
df$Date <- as.Date(df$Date, format="%d/%m/%Y")  # Convert Date column
df<-arrange(df, Date)
df$Change <- c(NA, diff(df$Price)) / df$Price  # Calculate daily price change
df$Price<-df$Price/df$Price[1]
return(df)
})
# Assign names to the list for easier reference
names(data_list) <- stocks
change_df<-data_list[[1]]$Date
for (i in 1:length(stocks)){
change_df<-cbind(change_df,data_list[[i]]$Change)
}
for (i in 2:horizon){
wealth_dist[i,]<-wealth_dist[i-1,]*(1+change_df[i,-1])
portfolio[i]=sum(wealth_dist[i,])
props<-wealth_dist[i,]/portfolio[i]
if (any(abs(props-allocation)>0.2*allocation)){
wealth_dist[i,]<-portfolio[i]*allocation
}
}
plot(portfolio, type = "l", col = "blue", lwd = 2, ylim = c(1,3),
xlab = "Time", ylab = "Price", main = "Portfolio")
for (i in 1:length(stocks)){
lines(data_list[[i]]$Price, col=palet[i],lwd=1)
}
# Add legend
legend("topleft", legend = c("Portfolio",stocks),
col=c("blue",palet), lwd = 1,
bty = "n",            # Remove border
cex = 0.5,            # Increase text size
xpd = TRUE)           # Allow drawing outside plot region)
wealth_dist!=data_list[["NVDA"]]$Price
data_list[["NVDA"]]$Price
portfolio
plot(data_list[["NVDA"]]$Change)
plot(cumprod(data_list[["NVDA"]]$Change), type="l")
plot(cumprod(data_list[["NVDA"]]$Change))
cumprod(data_list[["NVDA"]]$Change)
cumprod(data_list[["NVDA"]]$Change[-1])
cumprod((1+data_list[["NVDA"]]$Change[-1]))
plot(cumprod((1+data_list[["NVDA"]]$Change[-1])))
lines(data_list[["NVDA"]]$Price)
plot(1000*cumprod((1+data_list[["NVDA"]]$Change[-1])))
lines(1000*data_list[["NVDA"]]$Price)
diff(df$Price) / df$Price[-301]
library(tidyverse)
initial_wealth=1
allocation=c(1,0,0,0,0)
horizon=301
wealth_dist=matrix(nrow=horizon, ncol=5)
wealth_dist[1,]=allocation
portfolio<-numeric(horizon)
portfolio[1]<-1
# Define stock tickers
stocks <- c("NVDA", "AAPL", "AVGO", "JPM", "TSM")
palet <- c("green", "grey","red","navy", "pink")
# Read all CSV files and store them in a named list
data_list <- lapply(stocks, function(ticker) {
df <- read.csv(paste0(ticker, ".csv"))[,-7]  # Remove 7th column
df$Date <- as.Date(df$Date, format="%d/%m/%Y")  # Convert Date column
df<-arrange(df, Date)
df$Change <- c(diff(df$Price) / df$Price[-301],NA)  # Calculate daily price change
df$Price<-df$Price/df$Price[1]
return(df)
})
# Assign names to the list for easier reference
names(data_list) <- stocks
change_df<-data_list[[1]]$Date
for (i in 1:length(stocks)){
change_df<-cbind(change_df,data_list[[i]]$Change)
}
for (i in 2:horizon){
wealth_dist[i,]<-wealth_dist[i-1,]*(1+change_df[i-1,-1])
portfolio[i]=sum(wealth_dist[i,])
props<-wealth_dist[i,]/portfolio[i]
if (any(abs(props-allocation)>0.2*allocation)){
wealth_dist[i,]<-portfolio[i]*allocation
}
}
plot(portfolio, type = "l", col = "blue", lwd = 2, ylim = c(1,3),
xlab = "Time", ylab = "Price", main = "Portfolio")
for (i in 1:length(stocks)){
lines(data_list[[i]]$Price, col=palet[i],lwd=1)
}
# Add legend
legend("topleft", legend = c("Portfolio",stocks),
col=c("blue",palet), lwd = 1,
bty = "n",            # Remove border
cex = 0.5,            # Increase text size
xpd = TRUE)           # Allow drawing outside plot region)
library(tidyverse)
initial_wealth=1
allocation=c(0.5,0.5,0,0,0)
horizon=301
wealth_dist=matrix(nrow=horizon, ncol=5)
wealth_dist[1,]=allocation
portfolio<-numeric(horizon)
portfolio[1]<-1
# Define stock tickers
stocks <- c("NVDA", "AAPL", "AVGO", "JPM", "TSM")
palet <- c("green", "grey","red","navy", "pink")
# Read all CSV files and store them in a named list
data_list <- lapply(stocks, function(ticker) {
df <- read.csv(paste0(ticker, ".csv"))[,-7]  # Remove 7th column
df$Date <- as.Date(df$Date, format="%d/%m/%Y")  # Convert Date column
df<-arrange(df, Date)
df$Change <- c(diff(df$Price) / df$Price[-301],NA)  # Calculate daily price change
df$Price<-df$Price/df$Price[1]
return(df)
})
# Assign names to the list for easier reference
names(data_list) <- stocks
change_df<-data_list[[1]]$Date
for (i in 1:length(stocks)){
change_df<-cbind(change_df,data_list[[i]]$Change)
}
for (i in 2:horizon){
wealth_dist[i,]<-wealth_dist[i-1,]*(1+change_df[i-1,-1])
portfolio[i]=sum(wealth_dist[i,])
props<-wealth_dist[i,]/portfolio[i]
if (any(abs(props-allocation)>0.2*allocation)){
wealth_dist[i,]<-portfolio[i]*allocation
}
}
plot(portfolio, type = "l", col = "blue", lwd = 2, ylim = c(1,3),
xlab = "Time", ylab = "Price", main = "Portfolio")
for (i in 1:length(stocks)){
lines(data_list[[i]]$Price, col=palet[i],lwd=1)
}
# Add legend
legend("topleft", legend = c("Portfolio",stocks),
col=c("blue",palet), lwd = 1,
bty = "n",            # Remove border
cex = 0.5,            # Increase text size
xpd = TRUE)           # Allow drawing outside plot region)
props=matrix(nrow=horizon, ncol=5)
props[1,]=allocation
for (i in 2:horizon){
wealth_dist[i,]<-wealth_dist[i-1,]*(1+change_df[i-1,-1])
portfolio[i]=sum(wealth_dist[i,])
props[i,]<-wealth_dist[i,]/portfolio[i]
if (any(abs(props[i,]-allocation)>0.2*allocation)){
wealth_dist[i,]<-portfolio[i]*allocation
}
}
#Allocation ratios
plot(props, type = "l", col = "blue", lwd = 2, ylim = c(1,3),
xlab = "Time", ylab = "Price", main = "Portfolio")
",
#Allocation ratios
plot(props, type = "l", col = "blue", lwd = 2,
#Allocation ratios
plot(props, type = "l", col = "blue", lwd = 2,
xlab = "Time", ylab = "Price", main = "Portfolio")
#Allocation ratios
plot(props[1], type = "l", col = "blue", lwd = 2,
xlab = "Time", ylab = "Price", main = "Portfolio")
#Allocation ratios
plot(props[1,], type = "l", col = "blue", lwd = 2,
xlab = "Time", ylab = "Price", main = "Portfolio")
#Allocation ratios
plot(props[,1], type = "l", col = "blue", lwd = 2,
xlab = "Time", ylab = "Price", main = "Portfolio")
#Allocation ratios
plot(props[,1], type = "l", col = "blue", lwd = 2,
xlab = "Time", ylab = "Price", main = "Portfolio")
for (i in 2:length(stocks)){
lines(props[,i], col=palet[i])
}
# Add legend
legend("topright", legend = c("Portfolio",stocks),
col=c("blue",palet), lwd = 1,
bty = "n",            # Remove border
cex = 0.5,            # Increase text size
xpd = TRUE)           # Allow drawing outside plot region)
#Allocation ratios
plot(props[,1], type = "l", col = palet[1], lwd = 2,
xlab = "Time", ylab = "Price", main = "Portfolio")
for (i in 2:length(stocks)){
lines(props[,i], col=palet[i])
}
# Add legend
legend("topright", legend = c("Portfolio",stocks),
col=c(palet), lwd = 1,
bty = "n",            # Remove border
cex = 0.5,            # Increase text size
xpd = TRUE)           # Allow drawing outside plot region)
#Allocation ratios
plot(props[,1], type = "l", col = palet[1], lwd = 2,
xlab = "Time", ylab = "Price", main = "Portfolio allocation")
for (i in 2:length(stocks)){
lines(props[,i], col=palet[i])
}
# Add legend
legend("topright", legend = c(stocks),
col=c(palet), lwd = 1,
bty = "n",            # Remove border
cex = 0.5,            # Increase text size
xpd = TRUE)           # Allow drawing outside plot region)
#Allocation ratios
plot(props[,1], type = "l", col = palet[1], lwd = 2,
xlab = "Time", ylab = "Price", main = "Portfolio allocation")
for (i in 2:length(stocks)){
lines(props[,i], col=palet[i], lwd=2)
}
# Add legend
legend("topright", legend = c(stocks),
col=c(palet), lwd = 2,
bty = "n",            # Remove border
cex = 0.5,            # Increase text size
xpd = TRUE)           # Allow drawing outside plot region)
library(tidyverse)
initial_wealth=1
allocation=c(0.2,0.2,0.2,0.2,0.2)
horizon=301
wealth_dist=matrix(nrow=horizon, ncol=5)
wealth_dist[1,]=allocation
props=matrix(nrow=horizon, ncol=5)
props[1,]=allocation
portfolio<-numeric(horizon)
portfolio[1]<-1
# Define stock tickers
stocks <- c("NVDA", "AAPL", "AVGO", "JPM", "TSM")
palet <- c("green", "grey","red","navy", "pink")
# Read all CSV files and store them in a named list
data_list <- lapply(stocks, function(ticker) {
df <- read.csv(paste0(ticker, ".csv"))[,-7]  # Remove 7th column
df$Date <- as.Date(df$Date, format="%d/%m/%Y")  # Convert Date column
df<-arrange(df, Date)
df$Change <- c(diff(df$Price) / df$Price[-301],NA)  # Calculate daily price change
df$Price<-df$Price/df$Price[1]
return(df)
})
# Assign names to the list for easier reference
names(data_list) <- stocks
change_df<-data_list[[1]]$Date
for (i in 1:length(stocks)){
change_df<-cbind(change_df,data_list[[i]]$Change)
}
for (i in 2:horizon){
wealth_dist[i,]<-wealth_dist[i-1,]*(1+change_df[i-1,-1])
portfolio[i]=sum(wealth_dist[i,])
props[i,]<-wealth_dist[i,]/portfolio[i]
if (any(abs(props[i,]-allocation)>0.2*allocation)){
wealth_dist[i,]<-portfolio[i]*allocation
}
}
plot(portfolio, type = "l", col = "blue", lwd = 2, ylim = c(1,3),
xlab = "Time", ylab = "Price", main = "Portfolio")
for (i in 1:length(stocks)){
lines(data_list[[i]]$Price, col=palet[i],lwd=1)
}
# Add legend
legend("topleft", legend = c("Portfolio",stocks),
col=c("blue",palet), lwd = 1,
bty = "n",            # Remove border
cex = 0.5,            # Increase text size
xpd = TRUE)           # Allow drawing outside plot region)
#Allocation ratios
plot(props[,1], type = "l", col = palet[1], lwd = 2,
xlab = "Time", ylab = "Price", main = "Portfolio allocation")
for (i in 2:length(stocks)){
lines(props[,i], col=palet[i], lwd=2)
}
# Add legend
legend("topright", legend = c(stocks),
col=c(palet), lwd = 2,
bty = "n",            # Remove border
cex = 0.5,            # Increase text size
xpd = TRUE)           # Allow drawing outside plot region)
#Allocation ratios
plot(props[,1], type = "l", col = palet[1], lwd = 2, ylim=c(0.15,0.25),
xlab = "Time", ylab = "Price", main = "Portfolio allocation")
for (i in 2:length(stocks)){
lines(props[,i], col=palet[i], lwd=2)
}
# Add legend
legend("topright", legend = c(stocks),
col=c(palet), lwd = 2,
bty = "n",            # Remove border
cex = 0.5,            # Increase text size
xpd = TRUE)           # Allow drawing outside plot region)
data_list[["AVGO"]]
library(tidyverse)
initial_wealth=1
allocation=c(0.2,0.2,0.2,0.2,0.2)
horizon=301
wealth_dist=matrix(nrow=horizon, ncol=5)
wealth_dist[1,]=allocation
props=matrix(nrow=horizon, ncol=5)
props[1,]=allocation
portfolio<-numeric(horizon)
portfolio[1]<-1
# Define stock tickers
stocks <- c("NVDA", "AAPL", "AVGO", "JPM", "TSM")
palet <- c("green", "grey","red","navy", "pink")
# Read all CSV files and store them in a named list
data_list <- lapply(stocks, function(ticker) {
df <- read.csv(paste0(ticker, ".csv"))[,-7]  # Remove 7th column
df$Date <- as.Date(df$Date, format="%m/%d/%Y")  # Convert Date column
df<-arrange(df, Date)
df$Change <- c(diff(df$Price) / df$Price[-301],NA)  # Calculate daily price change
df$Price<-df$Price/df$Price[1]
return(df)
})
# Assign names to the list for easier reference
names(data_list) <- stocks
change_df<-data_list[[1]]$Date
for (i in 1:length(stocks)){
change_df<-cbind(change_df,data_list[[i]]$Change)
}
for (i in 2:horizon){
wealth_dist[i,]<-wealth_dist[i-1,]*(1+change_df[i-1,-1])
portfolio[i]=sum(wealth_dist[i,])
props[i,]<-wealth_dist[i,]/portfolio[i]
if (any(abs(props[i,]-allocation)>0.2*allocation)){
wealth_dist[i,]<-portfolio[i]*allocation
}
}
plot(portfolio, type = "l", col = "blue", lwd = 2, ylim = c(1,3),
xlab = "Time", ylab = "Price", main = "Portfolio")
for (i in 1:length(stocks)){
lines(data_list[[i]]$Price, col=palet[i],lwd=1)
}
# Add legend
legend("topleft", legend = c("Portfolio",stocks),
col=c("blue",palet), lwd = 1,
bty = "n",            # Remove border
cex = 0.5,            # Increase text size
xpd = TRUE)           # Allow drawing outside plot region)
#Allocation ratios
plot(props[,1], type = "l", col = palet[1], lwd = 2, ylim=c(0.15,0.25),
xlab = "Time", ylab = "Price", main = "Portfolio allocation")
for (i in 2:length(stocks)){
lines(props[,i], col=palet[i], lwd=2)
}
# Add legend
legend("topright", legend = c(stocks),
col=c(palet), lwd = 2,
bty = "n",            # Remove border
cex = 0.5,            # Increase text size
xpd = TRUE)           # Allow drawing outside plot region)
d
library(tidyverse)
initial_wealth=1
allocation=c(0.2,0.2,0.2,0.2,0.2)
horizon=301
wealth_dist=matrix(nrow=horizon, ncol=5)
wealth_dist[1,]=allocation
props=matrix(nrow=horizon, ncol=5)
props[1,]=allocation
portfolio<-numeric(horizon)
portfolio[1]<-1
# Define stock tickers
stocks <- c("NVDA", "AAPL", "AVGO", "JPM", "TSM")
palet <- c("green", "grey","red","navy", "pink")
# Read all CSV files and store them in a named list
data_list <- lapply(stocks, function(ticker) {
df <- read.csv(paste0(ticker, ".csv"))[,-7]  # Remove 7th column
df$Date <- as.Date(df$Date, format="%d/%m/%Y")  # Convert Date column
df<-arrange(df, Date)
df$Change <- c(diff(df$Price) / df$Price[-301],NA)  # Calculate daily price change
df$Price<-df$Price/df$Price[1]
return(df)
})
# Assign names to the list for easier reference
names(data_list) <- stocks
change_df<-data_list[[1]]$Date
for (i in 1:length(stocks)){
change_df<-cbind(change_df,data_list[[i]]$Change)
}
for (i in 2:horizon){
wealth_dist[i,]<-wealth_dist[i-1,]*(1+change_df[i-1,-1])
portfolio[i]=sum(wealth_dist[i,])
props[i,]<-wealth_dist[i,]/portfolio[i]
if (any(abs(props[i,]-allocation)>0.2*allocation)){
wealth_dist[i,]<-portfolio[i]*allocation
}
}
plot(portfolio, type = "l", col = "blue", lwd = 2, ylim = c(1,3),
xlab = "Time", ylab = "Price", main = "Portfolio")
for (i in 1:length(stocks)){
lines(data_list[[i]]$Price, col=palet[i],lwd=1)
}
# Add legend
legend("topleft", legend = c("Portfolio",stocks),
col=c("blue",palet), lwd = 1,
bty = "n",            # Remove border
cex = 0.5,            # Increase text size
xpd = TRUE)           # Allow drawing outside plot region)
#Allocation ratios
plot(props[,1], type = "l", col = palet[1], lwd = 2, ylim=c(0.15,0.25),
xlab = "Time", ylab = "Price", main = "Portfolio allocation")
for (i in 2:length(stocks)){
lines(props[,i], col=palet[i], lwd=2)
}
# Add legend
legend("topright", legend = c(stocks),
col=c(palet), lwd = 2,
bty = "n",            # Remove border
cex = 0.5,            # Increase text size
xpd = TRUE)           # Allow drawing outside plot region)
